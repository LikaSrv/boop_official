<%= turbo_frame_tag :all_slot do %>
  <div class="mx-5">
    <% start_hour = @professional.start_hour # Heure de début
        end_hour = @professional.end_hour  # Heure de fin
        interval = @professional.interval  # Durée entre les créneaux en minutes
      %>
    <% current_time = Time.parse("#{selected_date} #{start_hour}:00") %>
    <% end_time = Time.parse("#{selected_date} #{end_hour}:00") %>
    <div data-appointment-target="times">
      <% while current_time <= end_time do %>
        <%@appointments = Appointment.where(start_time: current_time, professional: professional)%>
        <% if (@appointments.empty?) %>
          <%= link_to current_time.strftime("%H:%M"), pro_show_user_path(current_user, professional,date: @selected_date, appointment: nil),
              class:"btn btn-outline-primary m-2",
              data: {time: current_time.strftime("%H:%M")}%>
        <% else %>
          <%= link_to current_time.strftime("%H:%M"), pro_show_user_path(current_user, professional,date: @selected_date, appointments: @appointments.map { |appointment| appointment.id }),
              class:"btn btn-outline-primary m-2 btn-info text-dark",
              data: {time: current_time.strftime("%H:%M"),
                    turbo: false}%>
        <% end %>
        <% current_time += interval.minutes %>
      <% end %>
    </div>
  </div>
<% end %>
